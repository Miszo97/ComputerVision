{% load static %}

<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Examples selection page</title>
    <link href="{% static 'number_recognition/examples_selection_styles.css' %}" rel="stylesheet">
</head>
<body>

<form id='deleted-examples-form' action="{% url 'number_recognition:update_examples' %}" method="post">
    {% csrf_token %}
    <input type="hidden" id="deleted-examples" name="deleted-examples">
</form>

<div id="Container">
    <div id="top-bar">
        <a href={% url 'number_recognition:index' %}>Go back!</a>
    </div>
    <input type="button" id="update-examples-button" value="Update!" onclick="updateExamples()">

    <div id="user-examples-gallery">

    </div>
</div>


</body>
</html>

<script src="{% static 'number_recognition/examples_selection_scripts.js' %}"></script>
<script>
    let userExamplesGallery, div, label, img, discardButton, exampleCanvas, pk, id, deletedExamples = [];


    {% for example in examples %}

        {{ example.label }}

        userExamplesGallery = document.getElementById('user-examples-gallery');

        div = document.createElement('div');
        div.id = 'user-example-instance_' + {{example.pk}};
        div.className = 'user-example-instance';

        discardButton = document.createElement('button');
        discardButton.innerText = 'Discard!';
        discardButton.onclick = () => {
            pk = {{example.pk}};
            id = 'user-example-instance_' + pk;
            userExamplesGallery.removeChild(document.getElementById(id));
            deletedExamples.push(pk);
        };

        exampleCanvas = document.createElement('canvas');


        exampleCanvas.style.border = '1px solid blue';
        exampleCanvas.width = 200;
        exampleCanvas.height = 200;
        img = new Image;

        img.src = '{{ example.drawing_base64 }}'

        exampleCanvas.getContext('2d').drawImage(img, 0, 0);

        label = document.createElement('p');
        label.innerText = {{ example.label }};

        div.appendChild(exampleCanvas);
        div.appendChild(label);
        div.appendChild(discardButton);
        userExamplesGallery.appendChild(div);

    {% endfor %}
</script>
